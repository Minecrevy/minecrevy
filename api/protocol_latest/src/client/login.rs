use minecrevy_io_str::{McRead, McWrite};
use minecrevy_protocol::Packet;

/// Tells the server to start the login sequence.
#[derive(Clone, PartialEq, Debug, McRead, McWrite, Packet)]
pub struct LoginStart {
    /// The player's username.
    #[options(max_len = 16)]
    pub name: String,
}

/// Replies to the server to allow packet encryption.
#[derive(Clone, PartialEq, Debug, McRead, McWrite, Packet)]
pub struct EncryptionResponse {
    /// The shared secret, encrypted with the server's public key.
    pub shared_secret: Vec<u8>,
    /// The verify token, encrypted with the server's public key.
    pub verify_token: Vec<u8>,
}

/// Replies to the server's custom handshake flow.
///
/// See [plugin request][`crate::server::PluginRequestLoginPacket`] for the server side.
#[derive(Clone, PartialEq, Debug, McRead, McWrite, Packet)]
pub struct LoginPluginResponse {
    /// Should match the ID generated by the server.
    #[options(varint = true)]
    pub id: i32,
    /// True if the client understands the request, false otherwise. No data follows if false.
    pub successful: bool,
    /// The data being communicated.
    #[options(length = "remaining")]
    pub data: Vec<u8>,
}
